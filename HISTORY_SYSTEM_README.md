# 🧠 מערכת היסטוריה חכמה לאפליקציית CoupleTasks

מערכת היסטוריה מתקדמת שלומדת מההרגלים שלך ומציעה השלמות אוטומטיות חכמות.

## ✨ מה המערכת כוללת?

### 🎯 השלמה אוטומטיה
- **הצעות מבוססות היסטוריה**: כשתתחיל לכתוב "ל", המערכת תציע "לחם" אם קנית אותו בעבר
- **הצעות חכמות**: הצעות מותאמות לזמן ויום (בוקר = לחם וחלב, ערב = ירקות לסלט)
- **למידה מתמשכת**: ככל שתשתמש יותר, ההצעות יהיו יותר מדויקות

### 📊 מעקב והיסטוריה
- **היסטוריית קניות**: כל מוצר שקנית נשמר ב-Firestore
- **היסטוריית מטלות**: כל מטלה שהשלמת נשמרת
- **סטטיסטיקות**: כמה פריטים קנית השבוע/חודש/בסך הכל
- **מוצרים פופולריים**: מה הכי נקנה אצלך

### 🔧 רכיבים חדשים

#### `AutoCompleteInput` 
קומפוננט השלמה אוטומטית מתקדם:
```jsx
<AutoCompleteInput
  value={inputValue}
  onChangeText={setInputValue}
  onSelectSuggestion={handleSuggestion}
  type="shopping" // או "tasks"
  maxSuggestions={6}
  showSmartSuggestions={true}
/>
```

#### `RecentHistoryWidget`
ווידג'ט שמציג פריטים אחרונים שנקנו/הושלמו:
```jsx
<RecentHistoryWidget 
  type="shopping" 
  onSeeAll={() => navigation.navigate('History')} 
/>
```

#### `HistoryStatsCard`
כרטיס סטטיסטיקות מפורט:
```jsx
<HistoryStatsCard type="shopping" />
```

## 📁 קבצים חדשים שנוצרו

### שירותים
- `src/services/historyService.js` - שירות ראשי לניהול היסטוריה
- `src/config/historyConfig.js` - הגדרות מערכת ההיסטוריה

### רכיבים
- `src/components/common/AutoCompleteInput.js` - רכיב השלמה אוטומטית
- `src/components/common/RecentHistoryWidget.js` - ווידג'ט היסטוריה אחרונה  
- `src/components/history/HistoryStatsCard.js` - כרטיס סטטיסטיקות

### מסכים
- `src/screens/HistoryScreen.js` - מסך היסטוריה מלא

### אבטחה
- `firestore.rules` - כללי אבטחה של Firestore

## 🚀 איך להפעיל

### 1. הגדרת Firestore
```bash
# אם עוד לא הוספת את Firestore לפרויקט Firebase
npm install @react-native-firebase/firestore
```

### 2. פריסת כללי אבטחה
```bash
# העלה את הקובץ firestore.rules לפרויקט Firebase
firebase deploy --only firestore:rules
```

### 3. עדכון Navigation (אופציונלי)
הוסף מסך היסטוריה ל-DrawerNavigator:
```jsx
<Drawer.Screen 
  name="History" 
  component={HistoryScreen}
  options={{
    drawerLabel: 'היסטוריה',
    drawerIcon: ({ color }) => (
      <Icon name="history" size={24} color={color} />
    ),
  }}
/>
```

## 🎮 איך להשתמש

### 1. הוספת מוצר לקניות
- התחל להקליד שם מוצר
- המערכת תציע השלמות מההיסטוריה
- בחר הצעה או המשך להקליד
- המוצר יישמר אוטומטית כשתסמן "נקנה"

### 2. הוספת מטלה
- התחל להקליד כותרת מטלה
- המערכת תציע מטלות דומות מההיסטוריה
- המטלה תישמר אוטומטית כשתסמן "הושלם"

### 3. צפייה בהיסטוריה
- גש למסך "היסטוריה" בתפריט הצד
- ראה סטטיסטיקות ופריטים אחרונים
- יצא את ההיסטוריה לגיבוי

## 🔒 אבטחה ופרטיות

- כל ההיסטוריה שמורה בחשבון האישי שלך בלבד
- אין גישה לנתונים של משתמשים אחרים
- ניתן למחוק היסטוריה ישנה (מעל 6 חודשים)
- אפשרות לייצא ולגבות את כל הנתונים

## 📈 הצעות חכמות

המערכת לומדת מההרגלים שלך ומציעה:

### 🌅 הצעות לפי זמן
- **בוקר (6:00-11:00)**: לחם, חלב, ביצים
- **ערב (17:00-20:00)**: ירקות לסלט, בשר לארוחת ערב

### 📅 הצעות לפי יום
- **סוף שבוע**: ניקוי הבית, כביסה, קניות שבועיות

### 🔥 הצעות פופולריות
- מוצרים שאתה קונה הכי הרבה
- מטלות שאתה עושה בתדירות גבוהה

## 🛠️ הגדרות מתקדמות

ערוך את `src/config/historyConfig.js` כדי לשנות:
- כמות זמן לשמירת היסטוריה
- מספר הצעות מקסימלי
- הפעלה/כיבוי הצעות חכמות
- הגדרות UI נוספות

## 🐛 פתרון בעיות

### ההצעות לא עובדות
1. וודא ש-Firestore מחובר
2. בדוק שכללי האבטחה עודכנו
3. בדוק את ה-console לשגיאות

### ההיסטוריה לא נשמרת
1. וודא שהמשתמש מחובר
2. בדוק את הרשאות Firestore
3. וודא שהפונקציות נקראות בזמן הנכון

### האפליקציה איטית
1. הפעל ניקוי היסטוריה ישנה
2. הפחת את מספר ההצעות המקסימלי
3. העלה את זמן ה-debounce בחיפוש

## 📞 תמיכה

יש בעיה? פתח Issue ב-GitHub או צור קשר עם המפתח.

---

**נהנה מהמערכת? תן ⭐ ל-repository!** 